@model IEnumerable<ResoureManager.Content.Models.BaseMetadata>

@{
    ViewBag.Title = "List";
}
<link rel="stylesheet" href="../Scripts/jqwidgets/styles/jqx.base.css" type="text/css" />
<script type="text/javascript" src="../Scripts/jqwidgets/jqxcore.js"></script>
<script type="text/javascript" src="../Scripts/jqwidgets/jqxsplitter.js"></script>
<script type="text/javascript" src="../Scripts/jqwidgets/jqxbuttons.js"></script>
<script type="text/javascript" src="../Scripts/jqwidgets/jqxscrollbar.js"></script>
<script type="text/javascript" src="../Scripts/jqwidgets/jqxpanel.js"></script>

<script type="text/javascript" src="../Scripts/jqwidgets/jqxdata.js"></script>
<script type="text/javascript" src="../Scripts/jqwidgets/jqxtree.js"></script>
<script type="text/javascript" src="../Scripts/jqwidgets/jqxscrollbar.js"></script>
<script type="text/javascript" src="../Scripts/jqwidgets/jqxmenu.js"></script>
<script type="text/javascript" src="../Scripts/jqwidgets/jqxwindow.js"></script>
<script type="text/javascript" src="../Scripts/jqwidgets/jqxloader.js"></script>
<script type="text/javascript" src="../Scripts/jqwidgets/jqxtabs.js"></script>

<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.js")" type="text/javascript"></script>
@section Scripts {
    <script>
        $(document).ready(function () {
            $('#resourceType').change(function () {
                window.location.href = 'List?resourceType=' + $('#resourceType').val();
            });

            $('#resourceWindow').jqxWindow({
                width: '400px',
                height: '300px',
                resizable: true,
                //okButton: $('#okButton'),
                //initContent: function () {
                //    $('#okButton').jqxButton({ width: '80px', disabled: false });
                //}
            });
        });
        function createMetadata() {
            //window.location.href = 'Create?resourceType=' + $('#resourceType').val();
            $('#loader').show();
            var selectedResourceType = $('#resourceType option:selected').val();
            //alert(selectedResourceType);
            $.ajax({
                url: '../MetadataManager/Create?directoryCode=' + selectedResourceType,
                success: function (data) {
                    $('#resourceWindow #titleContainer').html('添加元数据信息');
                    $('#resourceWindow #customWindowContent').empty().html(data);
                    $('#resourceWindow').jqxWindow('open');
                },
                complete: function () {
                    $('#loader').hide();
                }
            });
        }
        function editMetadataResource(itemCode) { }

        function viewMetadataResource(itemCode) { }

        function deleteMetadataResource(itemCode) { }
    </script>
}

<h2>元数据管理</h2>
<div>
    <span>@Html.Label("请选择资源类型：")</span>
    <span>
        @Html.DropDownList("resourceType", ViewBag.ResourceTypes as IEnumerable<SelectListItem>, htmlAttributes:new { @class="btn btn-default"})
    </span>
</div>  
 <p>
     <a onclick="createMetadata();" style="cursor:pointer;"class="btn btn-default">添  加</a>
</p>
 
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.FieldName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.FieldType)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.ResouceType)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.FieldName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.FieldType)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.ResouceType)
        </td>
        <td>
            <a onclick="editMetadataResource('@item.Code')" style="cursor:pointer;">编辑</a>
            <a onclick="viewMetadataResource('@item.Code')" style="cursor:pointer;">详细信息</a>
            <a onclick="deleteMetadataResource('@item.Code')" style="cursor:pointer;">删除</a>
        </td>
    </tr>
}

</table>
<div id="resourceWindow" style="display:none">
    <div id="customWindowHeader">
        <span id="titleContainer" style="float: left"></span>
    </div>
    <div id="customWindowContent" style="overflow: hidden">
    </div>
</div>

<div id="loader" class="Loading">
    请 稍 后...
</div>


