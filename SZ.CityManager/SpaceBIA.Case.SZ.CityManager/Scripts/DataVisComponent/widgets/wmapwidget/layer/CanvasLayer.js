define(["dojo/_base/declare","esri/geometry/Point","esri/geometry/ScreenPoint","esri/SpatialReference","../common/Class"],function(t,i,e,n,a){return t("CanvasLayer",[a],{constructor:function(t){this.options=t||{},this.paneName=this.options.paneName||"labelPane",this.zIndex=this.options.zIndex||0,this.context=this.options.context||"2d",this._map=t.map,this._init(this._map),this.show()},_init:function(t){this._map=t;var i=this.canvas=document.createElement("canvas");i.style.cssText="position:absolute;left:0;top:0;z-index:"+this.zIndex+";",this.adjustSize(),t.root.childNodes[0].appendChild(i);var e=this;return t.on("resize",function(){e.adjustSize(),e.draw()}),t.on("pan-end",function(){e.adjustSize(),e.draw()}),t.on("zoom-end",function(){e.adjustSize(),e.draw()}),this.canvas},adjustSize:function(){var t,i={width:this._map.width,height:this._map.height},e=this.canvas;t="webgl"==this.context?1:function(t){var i=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/i}(e.getContext("2d")),e.width=i.width*t,e.height=i.height*t,e.style.width=i.width+"px",e.style.height=i.height+"px"},draw:function(){var t=this._map,i={width:t.width,height:t.height},e=t.extent.getCenter();if(e){var n=this.geoCoord2Pixel(e);this.canvas.style.left=n.x-i.width/2+"px",this.canvas.style.top=n.y-i.height/2+"px",this.dispatchEvent("draw"),this.options.update&&this.options.update.call(this)}},getContainer:function(){return this.canvas},show:function(){!this.canvas,this.canvas.style.display="block"},hide:function(){this.canvas.style.display="none"},setZIndex:function(t){this.canvas.style.zIndex=t},getZIndex:function(){return this.zIndex},geoCoord2Pixel:function(t){var i=this._map.toScreen(t);return i},pixel2GeoCoord:function(t){var i=this._map.toMap(new e(t.x,t.y));return i}})});